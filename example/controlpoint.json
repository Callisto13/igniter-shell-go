{
  "defaults": {
    "arg.sourceTvDelay": "0",
    "arg.sourceTvMaxClients": "10",
    "arg.map": "cp_5gorge",
    "arg.hostname": "Gameye TF2 Control Points Match",
    "arg.maxPlayers": "6",
    "arg.maxRounds": "2",
    "arg.secured": "1",
    "arg.tournament": "1"
  },
  "cmd": [
    "-port",
    "${port.game}",
    "+map",
    "${arg.map}",
    "+hostname",
    "\"${arg.hostname}\"",
    "+maxplayers",
    "${arg.maxPlayers}",
    "-secured",
    "${arg.secured}",
    "+tv_port",
    "${port.hltv}",
    "+tv_delay",
    "${arg.sourceTvDelay}",
    "+tv_enable",
    "1",
    "+tf_allow_server_hibernation",
    "1"
  ],
  "files": [],
  "script": {
    "initialState": "idle",
    "states": {
      "configure": {
        "events": [
          {
            "type": "literal",
            "nextState": "idle",
            "value": "Configure ready..."
          }
        ]
      },
      "end": {
        "events": [
          {
            "type": "timer",
            "nextState": "quit",
            "interval": 10000
          }
        ]
      },
      "idle": {
        "events": [
          {
            "type": "literal",
            "nextState": "configure",
            "ignoreCase": true,
            "value": "'server.cfg' not present; not executing."
          },
          {
            "type": "regex",
            "nextState": "playing",
            "ignoreCase": true,
            "pattern": "^L\\s+\\d{2}\\/\\d{2}\\/\\d{4}\\s+\\-\\s+\\d{2}:\\d{2}:\\d{2}:\\s+World\\s+triggered\\s+\"Round_Start\""
          },
          {
            "type": "timer",
            "nextState": "quit",
            "interval": 900000
          }
        ]
      },
      "playing": {
        "events": [
          {
            "type": "regex",
            "nextState": "end",
            "ignoreCase": true,
            "pattern": "^L\\s+\\d{2}\\/\\d{2}\\/\\d{4}\\s+\\-\\s+\\d{2}:\\d{2}:\\d{2}:\\s+World\\s+triggered\\s+\"Game_Over\""
          },
          {
            "type": "literal",
            "nextState": "idle",
            "value": "Server is hibernating"
          }
        ]
      }
    },
    "transitions": [
      {
        "to": "configure",
        "command": "echo \"Configure...\"\necho \"Loading game mode cp\"            // Gameye TF2 game mode identifier\n\nlog on                                 // Enable server logging\n\nmp_maxrounds ${arg.maxRounds}          // Number of rounds to win before the game will end\n\nhost_framerate 0\n\ntf_tournament_classlimit_scout -1\ntf_tournament_classlimit_soldier -1\ntf_tournament_classlimit_pyro -1\ntf_tournament_classlimit_demoman -1\ntf_tournament_classlimit_heavy -1\ntf_tournament_classlimit_engineer -1\ntf_tournament_classlimit_medic -1\ntf_tournament_classlimit_sniper -1\ntf_tournament_classlimit_spy -1\n\nmp_allowspectators 1\nmp_bonusroundtime 10\nmp_disable_respawn_times 0\nmp_enableroundwaittime 1\nmp_fadetoblack 0\nmp_footsteps 1\nmp_forcecamera 1\nmp_fraglimit 0\nmp_friendlyfire 0\nmp_highlander 0\nmp_idledealmethod 0\nmp_match_end_at_timelimit 1\nmp_respawnwavetime 10.0\nmp_stalemate_enable 0\nmp_teams_unbalance_limit 0\nmp_tournament ${arg.tournament}\nmp_tournament_allow_non_admin_restart 0\nmp_tournament_stopwatch 1\n\nsv_allow_votes 0\nsv_allow_wait_command 0\nsv_allowupload 0\nsv_alltalk 0\nsv_cheats 0\nsv_client_max_interp_ratio 5\nsv_client_min_interp_ratio 1\nsv_client_predict 1\nsv_consistency 1\nsv_gravity 800\nsv_maxcmdrate 66\nsv_maxrate 0\nsv_maxupdaterate 66\nsv_mincmdrate 66\nsv_minrate 20000\nsv_minupdaterate 66\nsv_pausable 1\nsv_pure 2\nsv_pure_kick_clients 1\nsv_restrict_aspect_ratio_fov 0\nsv_timeout 10\n\ntf_arena_first_blood 0\ntf_avoidteammates_pushaway 0\ntf_clamp_airducks 1\ntf_ctf_bonus_time 0\ntf_damage_disablespread 1\ntf_teamtalk 1\ntf_tournament_hide_domination_icons 1\ntf_use_fixed_weaponspreads 1\ntf_weapon_criticals 0\ntf_dropped_weapon_lifetime 0\ntf_preround_push_from_damage_enable 1\ntf_spawn_glows_duration 0\n\ntv_name \"Gameye SourceTV Stream\"         // Title for SourceTV\ntv_title \"Gameye SourceTV Stream\"        // Title for SourceTV spectator UI\ntv_maxclients ${arg.sourceTvMaxClients}   // SourceTV max clients\ntv_autorecord 1                          // Autorecord SourceTV demo\ntv_delay ${arg.sourceTvDelay}            // SourceTV stream delay in seconds\ntv_delaymapchange 1\ntv_relayvoice 0\ntv_transmitall 1\ntv_delaymapchange 1                      // Delays map change until broadcast is complete\n\nmp_tournament_restart                    // Restart Tournament Mode on the current level\n\nsay ETF2L config (2016-01-26) loaded.\nsay * Please check that the settings are correct for this game mode!\nsay * You must record POV demos and take screenshots of all results.\n\necho \"Configure ready...\"\n"
      },
      {
        "to": "idle",
        "command": "echo \"Idle...\"\n"
      },
      {
        "to": "playing",
        "command": "echo \"Playing...\"\n"
      },
      {
        "to": "end",
        "command": "echo \"End...\"\nsay The match has ended, thank you for playing!\nsay This server will shutdown in 10 seconds\n"
      },
      {
        "to": "quit",
        "command": "echo \"Quit...\"\nquit"
      }
    ]
  }
}